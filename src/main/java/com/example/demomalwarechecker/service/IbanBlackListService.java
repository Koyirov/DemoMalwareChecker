package com.example.demomalwarechecker.service;

import com.example.demomalwarechecker.model.Iban;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

@Service
public class IbanBlackListService {

    private final List<Iban> ibanBlackList;

    public IbanBlackListService() {
        ibanBlackList = new ArrayList<>();

        Iban iban1 = new Iban(1,"DE15 3006 0601 4586 7807 80");
        Iban iban2 = new Iban(2,"DE15 3456 0742 0505 3542 75");
        Iban iban3 = new Iban(3,"DE15 7865 7965 0505 6258 24");
        Iban iban4 = new Iban(4,"DE15 1657 3647 4876 3654 47");
        Iban iban5 = new Iban(5,"DE15 3006 0601 0505 7807 80");

        ibanBlackList.addAll(Arrays.asList(iban1,iban2,iban3,iban4,iban5));
    }

    public List<Iban> getTrimmedIbanBlackList() {
        List<Iban> trimmedIbanBlackList = new ArrayList<>();
        for(Iban iban: ibanBlackList) {
            int ibanId = iban.getIndex();
            String trimmedIban = iban.getIban().replaceAll("\\s","");
            trimmedIbanBlackList.add(new Iban(ibanId, trimmedIban));
        }
        return trimmedIbanBlackList;
    }

    public boolean isIbanInBlackList(String contentOfDocument) {
        for (Iban iban: ibanBlackList){
            if(contentOfDocument.contains(iban.getIban())){
                return true;
            }
        }
        return isIbanInTrimmedBlackList(contentOfDocument);
    }


    public boolean isIbanInTrimmedBlackList(String contentOfDocument) {
        List<Iban> trimmedIbanBlackList = getTrimmedIbanBlackList();
        for (Iban iban: trimmedIbanBlackList){
            if(contentOfDocument.contains(iban.getIban())){
                return true;
            }
        }
        return false;
    }
}
